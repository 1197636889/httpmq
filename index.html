<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Httpmq : A simple HTTP message queue written in Go with goleveldb, just like httpsqs wriiten in C with Tokyo Cabinet.">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Httpmq</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/hnlq715/httpmq">View on GitHub</a>

          <h1 id="project_title">Httpmq</h1>
          <h2 id="project_tagline">A simple HTTP message queue written in Go with goleveldb, just like httpsqs wriiten in C with Tokyo Cabinet.</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/hnlq715/httpmq/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/hnlq715/httpmq/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a id="httpmq" class="anchor" href="#httpmq" aria-hidden="true"><span class="octicon octicon-link"></span></a>httpmq</h1>

<p>This program is a simple HTTP message queue written in Go with gdleveldb, just like httpsqs wriiten in C with Tokyo Cabinet.</p>

<h1>
<a id="feature" class="anchor" href="#feature" aria-hidden="true"><span class="octicon octicon-link"></span></a>Feature</h1>

<ul>
<li>Very simple, less than 300 lines Go code.</li>
<li>Very fast, more than 10000 requests/sec.</li>
<li>High concurrency, support the tens of thousands of concurrent connections.</li>
<li>Multiple queue.</li>
<li>Low memory consumption, mass data storage, storage dozens of GB of data takes less than 100MB of physical memory buffer.</li>
<li>Convenient to change the maximum queue length of per-queue.</li>
<li>Queue status view.</li>
<li>Be able to view the contents of the specified queue ID.</li>
<li>Multi-Character encoding support.</li>
</ul>

<h1>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h1>

<pre><code>  Usage of ./httpmq:
    -auth="": auth password to access httpmq
    -buffer=4: write buffer(MB)
    -cache=8: cache size(MB)
    -cpu=1: cpu number for httpmq
    -db="level.db": database path
    -ip="0.0.0.0": ip address to listen on
    -maxqueue=1000000: the max queue length
    -port="1218": port to listen on
    -readtimeout=15: read timeout for an http request
    -verbose=true: output log
    -writetimeout=15: write timeout for an http request
</code></pre>

<ol>
<li>
<p>PUT text message into a queue</p>

<p>HTTP GET protocol (Using curl for example):</p>

<pre><code>curl "http://host:port/?name=your_queue_name&amp;opt=put&amp;data=url_encoded_text_message&amp;auth=mypass123"
</code></pre>

<p>HTTP POST protocol (Using curl for example):</p>

<pre><code>curl -d "url_encoded_text_message" "http://host:port/?name=your_queue_name&amp;opt=put&amp;auth=mypass123"
</code></pre>
</li>
<li>
<p>GET text message from a queue</p>

<p>HTTP GET protocol (Using curl for example):</p>

<pre><code>curl "http://host:port/?charset=utf-8&amp;name=your_queue_name&amp;opt=get&amp;auth=mypass123"
</code></pre>
</li>
<li>
<p>View queue status</p>

<p>HTTP GET protocol (Using curl for example):</p>

<pre><code>curl "http://host:port/?name=your_queue_name&amp;opt=status&amp;auth=mypass123"
</code></pre>
</li>
<li>
<p>View queue details</p>

<p>HTTP GET protocol (Using curl for example):</p>

<pre><code>curl "http://host:port/?name=your_queue_name&amp;opt=view&amp;pos=1&amp;auth=mypass123"
</code></pre>
</li>
<li>
<p>Reset queue</p>

<p>HTTP GET protocol (Using curl for example):</p>

<pre><code>curl "http://host:port/?name=your_queue_name&amp;opt=reset&amp;pos=1&amp;auth=mypass123"
</code></pre>
</li>
</ol>

<h1>
<a id="benchmark" class="anchor" href="#benchmark" aria-hidden="true"><span class="octicon octicon-link"></span></a>Benchmark</h1>

<p>Test machine:</p>

<pre><code>  CPU:    2  AMD Athlon(tm) II X2 245 Processor
  Memory: Size: 2048 MB
          Locator: DIMM0
          Range Size: 2 GB
          Size: 2048 MB
          Locator: DIMM1
          Range Size: 2 GB
          Size: No Module Installed
          Locator: DIMM2
          Size: No Module Installed
          Locator: DIMM3
</code></pre>

<h3>
<a id="put-queue" class="anchor" href="#put-queue" aria-hidden="true"><span class="octicon octicon-link"></span></a>PUT queue:</h3>

<pre><code>ab -k -c 1000 -n 10000 "http://127.0.0.1:1218/?name=xoyo&amp;opt=put&amp;data=aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"
This is ApacheBench, Version 2.3 &lt;$Revision: 655654 $&gt;
Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/
Licensed to The Apache Software Foundation, http://www.apache.org/

Benchmarking 127.0.0.1 (be patient)
Completed 1000 requests
Completed 2000 requests
Completed 3000 requests
Completed 4000 requests
Completed 5000 requests
Completed 6000 requests
Completed 7000 requests
Completed 8000 requests
Completed 9000 requests
Completed 10000 requests
Finished 10000 requests


Server Software:        
Server Hostname:        127.0.0.1
Server Port:            1218

Document Path:          /?name=xoyo&amp;opt=put&amp;data=aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
Document Length:        13 bytes

Concurrency Level:      1000
Time taken for tests:   0.771 seconds
Complete requests:      10000
Failed requests:        0
Write errors:           0
Keep-Alive requests:    10000
Total transferred:      1640000 bytes
HTML transferred:       130000 bytes
Requests per second:    12964.69 [#/sec] (mean)
Time per request:       77.133 [ms] (mean)
Time per request:       0.077 [ms] (mean, across all concurrent requests)
Transfer rate:          2076.38 [Kbytes/sec] received

Connection Times (ms)
              min  mean[+/-sd] median   max
Connect:        0    2   7.7      0      41
Processing:     0   70  74.9     73     473
Waiting:        0   70  74.9     73     473
Total:          0   72  75.8     76     473

Percentage of the requests served within a certain time (ms)
  50%     76
  66%     91
  75%     98
  80%    110
  90%    183
  95%    216
  98%    272
  99%    310
 100%    473 (longest request)
</code></pre>

<h3>
<a id="get-queue" class="anchor" href="#get-queue" aria-hidden="true"><span class="octicon octicon-link"></span></a>GET queue:</h3>

<pre><code>ab -k -c 1000 -n 10000 "http://127.0.0.1:1218/?name=xoyo&amp;opt=get"                                                                                                   [system]
This is ApacheBench, Version 2.3 &lt;$Revision: 655654 $&gt;
Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/
Licensed to The Apache Software Foundation, http://www.apache.org/

Benchmarking 127.0.0.1 (be patient)
Completed 1000 requests
Completed 2000 requests
Completed 3000 requests
Completed 4000 requests
Completed 5000 requests
Completed 6000 requests
Completed 7000 requests
Completed 8000 requests
Completed 9000 requests
Completed 10000 requests
Finished 10000 requests


Server Software:        
Server Hostname:        127.0.0.1
Server Port:            1218

Document Path:          /?name=xoyo&amp;opt=get
Document Length:        512 bytes

Concurrency Level:      1000
Time taken for tests:   0.703 seconds
Complete requests:      10000
Failed requests:        0
Write errors:           0
Keep-Alive requests:    10000
Total transferred:      6640000 bytes
HTML transferred:       5120000 bytes
Requests per second:    14227.83 [#/sec] (mean)
Time per request:       70.285 [ms] (mean)
Time per request:       0.070 [ms] (mean, across all concurrent requests)
Transfer rate:          9225.86 [Kbytes/sec] received

Connection Times (ms)
              min  mean[+/-sd] median   max
Connect:        0    1   5.3      0      33
Processing:     0   49  61.2     20     449
Waiting:        0   49  61.2     20     449
Total:          0   50  62.0     22     471

Percentage of the requests served within a certain time (ms)
  50%     22
  66%     67
  75%     87
  80%    105
  90%    128
  95%    161
  98%    224
  99%    240
 100%    471 (longest request)
</code></pre>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Httpmq maintained by <a href="https://github.com/hnlq715">hnlq715</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
